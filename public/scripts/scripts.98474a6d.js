"use strict";angular.module("monitoringDashboardApp",["ngAnimate","ngCookies","ngResource","ngSanitize","ngTouch","ui.router","angular-flot","ngMap","bw.paging","ui.bootstrap","btford.socket-io","n3-pie-chart","angular.morris"]),function(){function a(a){a.$on("$stateChangeStart",function(b,c,d){a.toState=c,a.toStateParams=d})}function b(a,b){b.otherwise("/"),a.state("site",{"abstract":!0}).state("Home",{parent:"site",url:"/",data:{roles:[]},views:{"page@":{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"ctrl"}},params:{home:!0}}).state("Monitor",{parent:"site",url:"/monitor",data:{roles:[]},views:{"page@":{templateUrl:"views/monitor.html",controller:"MonitorCtrl",controllerAs:"ctrl"}},params:{home:!0}}).state("Control",{parent:"site",url:"/control",data:{roles:[]},views:{"page@":{templateUrl:"views/control.html",controller:"ControlCtrl",controllerAs:"ctrl"}},params:{home:!0}}).state("Lamps Settings",{parent:"site",url:"/lampsettings",data:{roles:[]},views:{"page@":{templateUrl:"views/lampsettings.html",controller:"LampSettingsCtrl",controllerAs:"ctrl"}},params:{home:!0}})}angular.module("monitoringDashboardApp").config(b).run(a),b.$inject=["$stateProvider","$urlRouterProvider"],a.$inject=["$rootScope"]}(),angular.module("monitoringDashboardApp").run(["$templateCache",function(a){a.put("views/control.html",'<div class="row"> <div class="col-lg-12"> <div class="box box-danger" ng-show="!ctrl.mode"> <div class="box-header with-border"> <i class="fa fa-gears"></i> <h3 class="box-title">Adjustment Table</h3> </div> <!-- /.box-header --> <div class="box-body"> <div class="row"> <div class="col-xs-6 col-md-6 col-lg-6"><label>Entries: </label> <select style="width:50px;height:30px;display:inline" ng-options="entry for entry in ctrl.entries" ng-model="ctrl.show"> </select> </div> </div> <br> <div class="row"> <div class="col-xs-8 col-xs-offset-2 col-md-6 col-lg-6 col-lg-offset-3 col-md-offset-3"> <div class="table-responsive"> <table class="table table-striped table-condensed table-hover"> <thead> <tr> <th style="text-align: center">Id</th> <th style="text-align: center">Adjustment</th> </tr> </thead> <tbody> <tr style="cursor:default" ng-repeat="lamp in ctrl.dataset |  limitTo: ctrl.show"> <td style="text-align: center">{{lamp.lampId}}</td> <td style="text-align: center">{{lamp.lightIntensityAdjustment*100 |number:2}}%</td> </tr> </tbody> </table> </div> </div> </div> </div> <div class="box-footer"> <div class="row"> <div class="col-lg-5 col-xs-12"> Showing {{ctrl.shift+1}} to {{ctrl.shift+ctrl.show}} of {{ctrl.data.length}} entries<br> </div> <div class="col-lg-7 col-xs-12"> <span class="pull-right"> <div paging page="ctrl.currentPage" page-size="ctrl.show" total="ctrl.data.length" paging-action="ctrl.pagingAction(page, pageSize)"> </div> </span> </div> </div> </div> </div> </div> </div>'),a.put("views/lampsettings.html",'<!-- Delete Mode--> <div class="row" ng-if="ctrl.mode === \'delete\'"> <div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offsest-2 col-xs-12"> <div class="box box-danger"> <div class="box-header with-border"> <h3 class="box-title">Delete Lamp</h3> </div> <div class="box-body"> <h4>You are going to delete this Lamp:</h4> <div class="col-xs-8 col-xs-offset-2"> <ul> <li><b>Id:</b> {{ctrl.selected.lampId}}</li> <li><b>Model:</b> {{ctrl.selected.model}}</li> <li><b>Address:</b> {{ctrl.selected.address}}</li> <li><b>Latitude:</b> {{ctrl.selected.latitude}}</li> <li><b>Longitude:</b> {{ctrl.selected.longitude}}</li> <li><b>Power Consumption:</b> {{ctrl.selected.consumption}}%</li> <li><b>Light Intensity:</b> {{ctrl.selected.lightIntensity}}%</li> <li><b>Substitution Date:</b> {{ctrl.selected.lastSubstitutionDate}}</li> <li><b>State:</b> <span ng-if="ctrl.selected.state_on">On</span><span ng-if="!ctrl.selected.state_on">Off</span></li> </ul> </div> </div> <div class="box-footer"> <div class="row"> <div class="col-xs-12 col-md-12 col-lg-12"> <button class="btn btn-flat btn-warning pull-right" style="margin-bottom:5px;margin-right:5px" tooltip-append-to-body="true" ng-click="ctrl.switchMode(null)" uib-tooltip="Go Back">Back <span class="fa fa-undo"></span></button> <button ng-disabled="ctrl.selected === null" class="btn btn-flat btn-danger pull-right" style="margin-bottom:5px;margin-right:5px" tooltip-append-to-body="true" ng-click="ctrl.deleteLamp()" uib-tooltip="Delete Selected Lamps">Delete <span class="fa fa-trash"></span></button> </div> </div> <div class="row"> <div class="col-xs-12 col-md-12 col-lg-12"> <div ng-if="ctrl.updateError" class="callout callout-danger pull-right" style="height=50px"> <p>Delete Error</p> </div> </div> </div> <div class="row"> <div class="col-xs-12 col-md-12 col-lg-12"> <div ng-if="ctrl.done" class="callout callout-success pull-right" style="height=50px"> <p>Delete Done</p> </div> </div> </div> </div> </div> </div> </div> <!-- Add Mode--> <div class="row" ng-if="ctrl.mode === \'add\'"> <div class="col-lg-8 col-lg-offset-2 col-md-8 col-md-offsest-2 col-xs-12"> <div class="box box-success"> <div class="box-header with-border"> <h3 class="box-title">Add Lamp</h3> </div> <!-- /.box-header --> <div class="box-body"> <h4>Insert new Lamp data:</h4> <form role="form"> <!-- text input --> <div class="row"> <div class="col-lg-10 col-lg-offset-1 col-md-10 col-md-offset-1 col-xs-10 col-xs-offset-1"> <div class="form-group"> <div class="col-xs-2" style="height:34px; padding-top:1%; padding-right: 0px"> <label class="control-label pull-right">Id</label> </div> <div class="col-xs-10"> <input type="text" class="form-control" placeholder="Id" ng-model="ctrl.newLamp.lampId"> </div> </div><br><br> <div class="form-group"> <div class="col-xs-2" style="height:34px; padding-top:1%; padding-right: 0px"> <label class="control-label pull-right">Model</label> </div> <div class="col-xs-10"> <input type="text" class="form-control" placeholder="Model" ng-model="ctrl.newLamp.model"> </div> </div><br><br> <div class="form-group"> <div class="col-xs-2" style="height:34px; padding-top:1%; padding-right: 0px"> <label class="control-label pull-right">Address</label> </div> <div class="col-xs-10"> <input type="text" class="form-control" placeholder="Address" ng-model="ctrl.newLamp.address"> </div> </div><br><br> <div class="form-group"> <div class="col-xs-2" style="height:34px; padding-top:1%; padding-right: 0px"> <label class="control-label pull-right">Latitude</label> </div> <div class="col-xs-10"> <input type="text" class="form-control" placeholder="Latitude" ng-model="ctrl.newLamp.latitude"> </div> </div><br><br> <div class="form-group"> <div class="col-xs-2" style="height:34px; padding-top:1%; padding-right: 0px"> <label class="control-label pull-right">Longitude</label> </div> <div class="col-xs-10"> <input type="text" class="form-control" placeholder="Longitude" ng-model="ctrl.newLamp.longitude"> </div> </div><br><br> <div class="form-group"> <div class="col-xs-2" style="height:34px; padding-top:1%; padding-right: 0px"> <label class="control-label pull-right">City</label> </div> <div class="col-xs-10"> <input type="text" class="form-control" placeholder="City" ng-model="ctrl.newLamp.city"> </div> </div><br><br> <div class="form-group"> <div class="col-xs-2" style="height:34px; padding-top:1%; padding-right: 0px"> <label class="control-label pull-right">Date</label> </div> <div class="col-xs-10"> <input type="text" class="form-control" placeholder="dd/mm/yyyy" ng-model="ctrl.lastSubstitutionDateShow"> </div> </div> </div> </div> </form> </div> <div class="box-footer"> <div class="row"> <div class="col-xs-12 col-md-12 col-lg-12"> <button class="btn btn-flat btn-warning pull-right" style="margin-bottom:5px;margin-right:5px" tooltip-append-to-body="true" ng-click="ctrl.switchMode(null)" uib-tooltip="Go Back">Back <span class="fa fa-undo"></span></button> <button class="btn btn-flat btn-success pull-right" style="margin-bottom:5px;margin-right:5px" tooltip-append-to-body="true" ng-click="ctrl.insertLamp()" uib-tooltip="Save added Lamp">Save <span class="fa fa-save"></span></button> </div> </div> <div class="row"> <div class="col-xs-12 col-md-12 col-lg-12"> <div ng-if="ctrl.formError" class="callout callout-danger pull-right" style="height=50px"> <p>Form Error</p> </div> </div> </div> <div class="row"> <div class="col-xs-12 col-md-12 col-lg-12"> <div ng-if="ctrl.updateError" class="callout callout-danger pull-right" style="height=50px"> <p>Insert Error</p> </div> </div> </div> <div class="row"> <div class="col-xs-12 col-md-12 col-lg-12"> <div ng-if="ctrl.done" class="callout callout-success pull-right" style="height=50px"> <p>Insert Done</p> </div> </div> </div> </div> </div> </div> </div> <div class="row"> <div class="col-lg-12"> <div class="box box-danger" ng-show="!ctrl.mode"> <div class="box-header with-border"> <i class="fa fa-table"></i> <h3 class="box-title">Lamps Table</h3> </div> <!-- /.box-header --> <div class="box-body"> <div class="alert alert-warning alert-dismissible" ng-show="!ctrl.clicked"> <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button> <i class="icon fa fa-info"></i>Click on item to enable Delete Button </div> <div class="row"> <div class="col-xs-6 col-md-6 col-lg-6"><label>Entries: </label> <select style="width:50px;height:30px;display:inline" ng-options="entry for entry in ctrl.entries" ng-model="ctrl.show"> </select> </div> <div class="col-xs-6 col-md-6 col-lg-6"><span class="pull-right"><input ng-model="ctrl.searchText" placeholder="Search..."></span> </div> </div> <div class="row" style="margin-top: 5px"> <div class="col-xs-12 col-md-12 col-lg-12"> <button ng-disabled="ctrl.selected === null" class="btn btn-xs btn-flat btn-danger pull-right" style="margin-bottom:5px;margin-right:5px" tooltip-append-to-body="true" ng-click="ctrl.switchMode(\'delete\')" uib-tooltip="Delete Selected Lamps">Delete <span class="fa fa-trash"></span></button> <button class="btn btn-xs btn-flat btn-success pull-right" style="margin-bottom:5px;margin-right:5px" tooltip-append-to-body="true" ng-click="ctrl.switchMode(\'add\')" uib-tooltip="Add New Lamp">New <span class="fa fa-plus"></span></button> </div> </div> <div class="table-responsive"> <table class="table table-condensed"> <thead> <tr> <th>Id</th> <th>Location</th> <th style="text-align: center">Model</th> <th style="text-align: center">Sub. Date</th> </tr> </thead> <tbody> <tr style="cursor:pointer" ng-repeat="lamp in ctrl.dataset | filter:ctrl.searchFilter | limitTo: ctrl.show" ng-class="{\'selected\': ctrl.selected === lamp}" ng-click="ctrl.select(lamp)"> <td>{{lamp.lampId}}</td> <td>{{lamp.address}}, &lt;{{lamp.latitude}},{{lamp.longitude}}&gt;</td> <td style="text-align: center">{{lamp.model}}</td> <td style="text-align: center">{{lamp.lastSubstitutionDate | date:\'dd/MM/yyyy \'}}</td> </tr> </tbody> </table> </div> </div> <div class="box-footer"> <div class="row"> <div class="col-lg-5 col-xs-12"> Showing {{ctrl.shift+1}} to {{ctrl.shift+ctrl.show}} of {{ctrl.data.length}} entries </div> <div class="col-lg-7 col-xs-12"> <span class="pull-right"> <div paging page="ctrl.currentPage" page-size="ctrl.show" total="ctrl.data.length" paging-action="ctrl.pagingAction(page, pageSize)"> </div> </span> </div> </div> </div> </div> </div> </div>'),a.put("views/main.html",'<div class="row"> <div class="col-lg-10 col-lg-offset-1 col-md-offset-1 col-md-10"> <h2>Welcome to Light Control-Monitoring System!</h2><br> <p align="justify"> The main goal of this project is to provide a system to manage the illumination network of a Smart City.<br><br> <b>Light Control-Monitoring System</b> is made-up of three main sections: <ul> <li><p align="justify"><b>Monitoring System:</b> through this section it is possible to see the latest faulty street lamps in the network, the oldest street lamps, or statistics over power consumption to plan maintenance operations. </p></li> <li><p align="justify"><b>Control System:</b> in this section it is possible to see the latest operations made to control the network of street lights of the city in automatic way, as the light intensity adaptation according to the luminous intensity of natural light or the intensity of vehicular traffic.</p></li> <li><p align="justify"><b>Lamps Settings:</b> section provides the capability to manage the network of street lights, adding or removing a lamp or a set of lamps.</p></li> </ul> </p> </div> </div>'),a.put("views/monitor.html",'<div class="row"> <div class="col-lg-6 col-md-6 col-xs-12"> <div class="box box-danger"> <div class="box-header with-border"> <i class="fa fa-table"></i> <h3 class="box-title">Residual Lifetime Rank</h3> </div> <!-- /.box-header --> <div class="box-body" style="height: 45vh !important"> <div class="table-responsive"> <table class="table table-striped table-condensed table-hover"> <thead> <tr> <th>Id</th> <th>Location</th> <th style="text-align: center">Residual Lifetime</th> </tr> </thead> <tbody> <tr ng-repeat="lamp in ctrl.rankData | limitTo:5"> <td>{{lamp.lampId}}</td> <td>{{lamp.address}}</td> <td style="text-align: center">{{lamp.residualLifeTimeShow}}</td> </tr> </tbody> </table> </div> </div> <div class="box-footer"> </div> </div> </div> <div class="col-lg-6 col-md-6 col-xs-12"> <div class="box box-danger"> <div class="box-header with-border"> <i class="fa fa-warning"></i> <h3 class="box-title">Warning Faulty Lamps</h3> </div> <!-- /.box-header --> <div class="box-body" style="height: 45vh !important;\n                 overflow-y: scroll !important"> <div ng-repeat="warning in ctrl.warnings" class="alert alert-danger alert-dismissible" ng-show="!ctrl.clicked" style="margin-bottom: 5px"> <button type="button" class="close" data-dismiss="alert" aria-hidden="true" ng-click="ctrl.deleteWarning($index)">×</button> <i class="icon fa fa-warning"></i>Detected Faulty Lamp {{warning.lampId}} - {{warning.address}} - {{ warning.timestamp | date:\'dd/MM/yyyy HH:mm:ss \'}} </div> </div> <div class="box-footer"> </div> </div> </div> </div> <div class="row"> <div class="col-lg-5 col-md-6 col-xs-12"> <div class="box box-danger"> <div class="box-header with-border"> <i class="fa fa-pie-chart"></i> <h3 class="box-title">City Average Consumption</h3> </div> <div class="box-body"> <br> <div class="row"> <div class="col-xs-4 col-md-6 col-lg-6"> <div class="chart" style="height: 200px"> <pie-chart data="ctrl.cityData[0]" options="ctrl.pieChartOptions"></pie-chart> </div> </div> <div class="col-xs-4 col-md-6 col-lg-6"> <div class="chart" style="height: 200px"> <pie-chart data="ctrl.cityData[1]" options="ctrl.pieChartOptions"></pie-chart> </div> </div> <div class="col-xs-4 col-md-6 col-md-offset-3 col-lg-6 col-lg-offset-3" style> <div class="chart" style="height: 200px"> <pie-chart data="ctrl.cityData[2]" options="ctrl.pieChartOptions"></pie-chart> </div> </div> </div> </div> </div> </div> <div class="col-lg-7 col-md-6 col-xs-12"> <div class="box box-danger"> <div class="box-header with-border"> <i class="fa fa-map"></i> <h3 class="box-title">Lamps Map</h3> </div> <div class="box-body"> <div ng-show="ctrl.showAlert" class="alert alert-warning alert-dismissible" ng-show="!ctrl.clicked"> <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button> <i class="icon fa fa-info"></i>Click on marker to see Lamp Consumption Details </div> <div map-lazy-load="https://maps.google.com/maps/api/js"> <ng-map default-style="true" center="41.890841, 12.493261" zoom="15"> <marker id="{{lamp.lampId}}" position="{{lamp.position}}" ng-repeat="lamp in ctrl.lamps" on-click="ctrl.showDetail(lamp)"> </marker> <info-window id="foo-iw"> <div ng-non-bindable=""> <b>Id:</b> {{ctrl.lamp.lampId}}<br> <b>Address:</b> {{ctrl.lamp.address}}<br> <b>Position:</b> {{ctrl.map.markers[ctrl.lamp.lampId].getPosition()}}<br> <b>Avg. Consumption [h]:</b> {{ctrl.lamp.h_consumption | number:2}} W<br> <b>Avg. Consumption [d]:</b> {{ctrl.lamp.d_consumption | number:2}} W<br> <b>Avg. Consumption [w]:</b> {{ctrl.lamp.w_consumption | number:2}} W<br> </div> </info-window> </ng-map> </div> </div> <div class="box-footer"> <button class="btn btn-xs btn-flat btn-danger pull-right" ng-click="ctrl.showDetail(e, ctrl.lamp)" style="margin-left:5px"> Show </button> <button class="btn btn-xs btn-flat btn-danger pull-right" ng-click="ctrl.hideDetail(e, ctrl.lamp)"> Hide </button> </div> </div> </div> </div> <div class="row"> <div class="col-lg-12 col-md-12 col-xs-12"> <div class="box box-danger"> <div class="box-header with-border"> <i class="fa fa-globe"></i> <h3 class="box-title">Street Consumption</h3> </div> <!-- /.box-header --> <div class="box-body"><br> <div class="row"> <div class="col-xs-6 col-md-6 col-lg-6"><label>Entries: </label> <select style="width:50px;height:30px;display:inline" ng-options="entry for entry in ctrl.entries" ng-model="ctrl.show"> </select> </div> </div><br> <div class="table-responsive"> <table class="table table-striped table-condensed table-hover"> <thead> <tr> <th>Street</th> <th style="text-align: center">Consumption[h]</th> <th style="text-align: center">Consumption[d]</th> <th style="text-align: center">Consumption[w]</th> <th style="text-align: center">Median</th> </tr> </thead> <tbody> <tr ng-repeat="street in ctrl.streetDataset | limitTo: ctrl.show"> <td>{{street.address}}</td> <td style="text-align: center">{{street.h_consumption | number:2}} W</td> <td style="text-align: center">{{street.d_consumption | number:2}} W</td> <td style="text-align: center">{{street.w_consumption | number:2}} W</td> <td style="text-align: center">{{street.median*100 | number:2}}%</td> </tr> </tbody> </table> </div> </div> <div class="box-footer"> <div class="row"> <div class="col-lg-5 col-xs-12"> Showing {{ctrl.shift+1}} to {{ctrl.shift+ctrl.show}} of {{ctrl.streetData.length}} entries </div> <div class="col-lg-7 col-xs-12"> <span class="pull-right"> <div paging page="ctrl.currentPage" page-size="ctrl.show" total="ctrl.streetData.length" paging-action="ctrl.pagingAction(page, pageSize)"> </div> </span> </div> </div> </div> </div> </div> </div>')}]);